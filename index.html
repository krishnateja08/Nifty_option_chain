<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 50 Daily Report</title>
    <link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@400;600;700;800&family=Rajdhani:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600;700&family=Outfit:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        html{scroll-behavior:smooth;}
        body{font-family:'Rajdhani',sans-serif;background:linear-gradient(135deg,#0f2027 0%,#203a43 50%,#2c5364 100%);min-height:100vh;padding:clamp(8px,2vw,24px);color:#b0bec5;overflow-x:hidden;-webkit-text-size-adjust:100%;}

        .tab-nav{display:flex;gap:0;border-bottom:2px solid rgba(79,195,247,0.2);overflow-x:auto;scrollbar-width:none;background:linear-gradient(135deg,#0f2027,#203a43);}
        .tab-nav::-webkit-scrollbar{display:none;}
        .tab-btn{display:flex;align-items:center;gap:8px;padding:13px clamp(14px,2.5vw,28px);font-family:'Oxanium',sans-serif;font-size:clamp(10px,1.4vw,13px);font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:rgba(176,190,197,0.5);cursor:pointer;border:none;background:transparent;border-bottom:3px solid transparent;white-space:nowrap;transition:all 0.25s ease;position:relative;bottom:-2px;}
        .tab-btn:hover{color:#4fc3f7;background:rgba(79,195,247,0.05);}
        .tab-btn.active{color:#4fc3f7;border-bottom-color:#4fc3f7;background:rgba(79,195,247,0.08);}
        .tab-dot{width:7px;height:7px;border-radius:50%;background:rgba(79,195,247,0.3);flex-shrink:0;transition:all 0.25s ease;}
        .tab-btn.active .tab-dot{background:#4fc3f7;box-shadow:0 0 8px #4fc3f7;}
        .tab-badge{font-size:9px;padding:2px 7px;border-radius:10px;background:rgba(79,195,247,0.12);border:1px solid rgba(79,195,247,0.25);color:#4fc3f7;}
        .new-badge .tab-badge{background:rgba(0,230,118,0.12);border-color:rgba(0,230,118,0.3);color:#00e676;}
        .tab-panel{display:none;}
        .tab-panel.active{display:block;}

        .container{max-width:1200px;margin:0 auto;background:rgba(15,32,39,0.85);backdrop-filter:blur(20px);border-radius:clamp(12px,2vw,20px);overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.5);border:1px solid rgba(79,195,247,0.18);min-width:0;}
        .header{background:linear-gradient(135deg,#0f2027,#203a43);padding:clamp(16px,3vw,32px) clamp(14px,3vw,30px) 0;text-align:center;position:relative;overflow:hidden;}
        .header::before{content:'';position:absolute;inset:0;background:radial-gradient(circle at 50% 50%,rgba(79,195,247,0.08) 0%,transparent 70%);pointer-events:none;}
        .header h1{font-family:'Oxanium',sans-serif;font-size:clamp(16px,3.5vw,30px);font-weight:800;color:#4fc3f7;text-shadow:0 0 30px rgba(79,195,247,0.5);letter-spacing:clamp(0.5px,0.3vw,2px);position:relative;z-index:1;word-break:break-word;margin-bottom:clamp(10px,2vw,18px);}
        .status-bar{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;gap:0;background:rgba(0,0,0,0.30);border:1px solid rgba(79,195,247,0.15);border-radius:10px;padding:0;overflow:hidden;position:relative;z-index:1;box-shadow:inset 0 1px 0 rgba(79,195,247,0.12);margin-bottom:16px;}
        .sb-item{display:flex;align-items:center;gap:8px;padding:10px clamp(10px,2vw,20px);flex:1 1 auto;min-width:0;border-right:1px solid rgba(79,195,247,0.10);white-space:nowrap;}
        .sb-item:last-child{border-right:none;}
        .sb-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
        .sb-dot-gen{background:#00e676;box-shadow:0 0 8px #00e676;}
        .sb-dot-clock{background:#4fc3f7;box-shadow:0 0 8px #4fc3f7;}
        .sb-dot-updated{background:#ffb74d;box-shadow:0 0 8px #ffb74d;animation:sb-pulse 2s ease-in-out infinite;}
        .sb-dot-cd{background:#b388ff;box-shadow:0 0 8px #b388ff;}
        @keyframes sb-pulse{50%{opacity:0.2;}}
        .sb-label{font-family:'JetBrains Mono',monospace;font-size:clamp(8px,1vw,9px);letter-spacing:1.8px;text-transform:uppercase;color:rgba(128,222,234,0.40);flex-shrink:0;}
        .sb-value{font-family:'JetBrains Mono',monospace;font-size:clamp(10px,1.3vw,12px);font-weight:700;color:#e0f7fa;overflow:hidden;text-overflow:ellipsis;}
        .sb-value.gen-val{color:#80deea;} .sb-value.clock-val{color:#4fc3f7;font-size:clamp(11px,1.5vw,13px);} .sb-value.updated-val{color:#ffb74d;} .sb-value.cd-val{color:#b388ff;min-width:28px;}

        .section{padding:clamp(14px,2.5vw,28px) clamp(12px,2.5vw,26px);border-bottom:1px solid rgba(79,195,247,0.08);}
        .section:last-child{border-bottom:none;}
        .section-title{font-family:'Oxanium',sans-serif;font-size:clamp(10px,1.5vw,13px);font-weight:700;letter-spacing:clamp(1px,0.3vw,2.5px);color:#4fc3f7;text-transform:uppercase;display:flex;align-items:center;gap:10px;margin-bottom:clamp(12px,2vw,20px);padding-bottom:12px;border-bottom:1px solid rgba(79,195,247,0.18);flex-wrap:wrap;}
        .section-title span{font-size:clamp(14px,2vw,18px);}

        .g{background:rgba(255,255,255,0.04);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(79,195,247,0.18);border-radius:16px;position:relative;overflow:hidden;transition:all 0.35s cubic-bezier(0.4,0,0.2,1);min-width:0;}
        .g::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.25),transparent);z-index:1;}
        .g::after{content:'';position:absolute;top:-60%;left:-30%;width:50%;height:200%;background:linear-gradient(105deg,transparent,rgba(255,255,255,0.04),transparent);transform:skewX(-15deg);transition:left 0.6s ease;z-index:0;}
        .g:hover::after{left:130%;}
        .g:hover{background:rgba(79,195,247,0.09);border-color:rgba(79,195,247,0.45);box-shadow:0 12px 40px rgba(0,0,0,0.35),inset 0 1px 0 rgba(255,255,255,0.1);transform:translateY(-4px);}
        .g-hi{background:rgba(79,195,247,0.09);border-color:rgba(79,195,247,0.35);}
        .g-red{background:rgba(244,67,54,0.06);border-color:rgba(244,67,54,0.25);}
        .g-red:hover{background:rgba(244,67,54,0.1);border-color:rgba(244,67,54,0.45);}
        .card-grid{display:grid;gap:14px;}
        .grid-5{grid-template-columns:repeat(5,minmax(0,1fr));}
        .grid-4{grid-template-columns:repeat(4,minmax(0,1fr));}
        .g .card-top-row{display:flex;align-items:center;gap:10px;margin-bottom:10px;position:relative;z-index:2;padding:14px 16px 0;}
        .card-ico{font-size:clamp(16px,2vw,22px);line-height:1;flex-shrink:0;}
        .lbl{font-size:clamp(8px,1vw,9px);letter-spacing:2.5px;color:rgba(128,222,234,0.65);text-transform:uppercase;font-weight:600;line-height:1.3;word-break:break-word;}
        .val{font-family:'Oxanium',sans-serif;font-size:clamp(16px,2.5vw,24px);font-weight:700;color:#fff;display:block;margin-bottom:10px;position:relative;z-index:2;padding:0 16px;word-break:break-word;overflow:hidden;text-overflow:ellipsis;}
        .bar-wrap{height:5px;background:rgba(0,0,0,0.35);border-radius:3px;margin:0 16px 12px;overflow:hidden;position:relative;z-index:2;}
        .bar-fill{height:100%;border-radius:3px;transition:width 1.2s cubic-bezier(0.4,0,0.2,1);}
        .bar-teal{background:linear-gradient(90deg,#00bcd4,#4fc3f7);box-shadow:0 0 8px rgba(79,195,247,0.6);}
        .bar-red{background:linear-gradient(90deg,#f44336,#ff5722);box-shadow:0 0 8px rgba(244,67,54,0.5);}
        .bar-gold{background:linear-gradient(90deg,#ffb74d,#ffd54f);box-shadow:0 0 8px rgba(255,183,77,0.5);}
        .card-foot{display:flex;justify-content:space-between;align-items:center;padding:0 16px 14px;position:relative;z-index:2;flex-wrap:wrap;gap:4px;}
        .sub{font-size:10px;color:#455a64;font-family:'JetBrains Mono',monospace;}
        .tag{display:inline-flex;align-items:center;padding:3px 11px;border-radius:20px;font-size:clamp(9px,1.2vw,11px);font-weight:700;letter-spacing:0.5px;font-family:'Rajdhani',sans-serif;white-space:nowrap;}
        .tag-neu{background:rgba(255,183,77,0.15);color:#ffb74d;border:1px solid rgba(255,183,77,0.35);}
        .tag-bull{background:rgba(0,229,255,0.12);color:#00e5ff;border:1px solid rgba(0,229,255,0.35);}
        .tag-bear{background:rgba(255,82,82,0.12);color:#ff5252;border:1px solid rgba(255,82,82,0.35);}

        .snap-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:14px;}
        .snap-card{padding:18px 16px;}
        .snap-card .card-top-row{margin-bottom:8px;padding:0;}
        .snap-card .val{font-size:clamp(18px,3vw,26px);padding:0;margin-bottom:0;}

        .md-widget{position:relative;overflow:hidden;background:linear-gradient(135deg,rgba(255,255,255,0.07),rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:clamp(12px,2vw,16px) clamp(14px,2vw,20px);backdrop-filter:blur(20px);display:flex;flex-direction:column;gap:12px;}
        .md-glow{position:absolute;top:-80%;left:-80%;width:260%;height:260%;background:conic-gradient(from 180deg,#ff6b35 0deg,#ffcd3c 120deg,#4ecdc4 240deg,#ff6b35 360deg);opacity:0.05;animation:md-rotate 8s linear infinite;border-radius:50%;pointer-events:none;}
        @keyframes md-rotate{to{transform:rotate(360deg);}}
        .md-row-top{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;position:relative;z-index:1;}
        .md-label{display:flex;align-items:center;gap:7px;font-family:'Space Mono',monospace;font-size:clamp(7px,1vw,8px);letter-spacing:3px;color:rgba(255,255,255,0.3);text-transform:uppercase;}
        .md-live-dot{width:6px;height:6px;border-radius:50%;background:#4ecdc4;box-shadow:0 0 8px #4ecdc4;animation:md-pulse 2s ease-in-out infinite;flex-shrink:0;}
        @keyframes md-pulse{50%{opacity:0.25;}}
        .md-pills-top{display:flex;gap:8px;flex-wrap:wrap;}
        .md-pill{font-family:'Space Mono',monospace;font-size:clamp(8px,1.2vw,10px);font-weight:700;padding:4px clamp(8px,1.5vw,14px);border-radius:20px;letter-spacing:1px;white-space:nowrap;}
        .md-pill-bull{background:rgba(78,205,196,0.12);border:1px solid rgba(78,205,196,0.4);color:#4ecdc4;}
        .md-pill-bear{background:rgba(255,100,100,0.12);border:1px solid rgba(255,100,100,0.4);color:#ff6b6b;}
        .md-pill-conf-high{background:rgba(78,205,196,0.12);border:1px solid rgba(78,205,196,0.35);color:#4ecdc4;}
        .md-pill-conf-med{background:rgba(255,205,60,0.12);border:1px solid rgba(255,205,60,0.35);color:#ffcd3c;}
        .md-pill-conf-low{background:rgba(255,107,107,0.12);border:1px solid rgba(255,107,107,0.35);color:#ff6b6b;}
        .md-row-bottom{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;position:relative;z-index:1;}
        .md-direction{font-family:'Orbitron',monospace;font-weight:900;font-size:clamp(22px,5vw,36px);letter-spacing:clamp(1px,0.5vw,3px);line-height:1;}

        .logic-box{background:rgba(79,195,247,0.04);border:1px solid rgba(79,195,247,0.14);border-left:3px solid #4fc3f7;border-radius:10px;padding:10px 16px;margin-top:12px;}
        .logic-box-head{font-family:'Oxanium',sans-serif;font-size:10px;font-weight:700;color:#4fc3f7;letter-spacing:2px;margin-bottom:7px;}
        .logic-grid{display:grid;grid-template-columns:1fr 1fr;gap:5px 20px;}
        .logic-item{display:flex;align-items:center;gap:7px;font-size:clamp(10px,1.3vw,11px);color:rgba(176,190,197,0.6);flex-wrap:wrap;}
        .logic-item .lv{font-family:'JetBrains Mono',monospace;font-size:10px;color:rgba(176,190,197,0.4);}
        .lc-bull{display:inline-flex;align-items:center;font-family:'JetBrains Mono',monospace;font-size:9px;font-weight:600;padding:2px 8px;border-radius:4px;white-space:nowrap;background:rgba(0,230,118,0.1);color:#00e676;border:1px solid rgba(0,230,118,0.28);}
        .lc-bear{display:inline-flex;align-items:center;font-family:'JetBrains Mono',monospace;font-size:9px;font-weight:600;padding:2px 8px;border-radius:4px;white-space:nowrap;background:rgba(255,82,82,0.1);color:#ff5252;border:1px solid rgba(255,82,82,0.28);}
        .lc-side{display:inline-flex;align-items:center;font-family:'JetBrains Mono',monospace;font-size:9px;font-weight:600;padding:2px 8px;border-radius:4px;white-space:nowrap;background:rgba(255,183,77,0.1);color:#ffb74d;border:1px solid rgba(255,183,77,0.28);}
        .lc-info{display:inline-flex;align-items:center;font-family:'JetBrains Mono',monospace;font-size:9px;font-weight:600;padding:2px 8px;border-radius:4px;white-space:nowrap;background:rgba(79,195,247,0.08);color:#4fc3f7;border:1px solid rgba(79,195,247,0.22);}

        .rl-node-a{position:absolute;bottom:0;transform:translateX(-50%);text-align:center;}
        .rl-node-b{position:absolute;top:0;transform:translateX(-50%);text-align:center;}
        .rl-dot{width:12px;height:12px;border-radius:50%;border:2px solid rgba(10,20,35,0.9);}
        .rl-lbl{font-size:clamp(8px,1.2vw,10px);font-weight:700;text-transform:uppercase;letter-spacing:0.6px;line-height:1.4;white-space:nowrap;color:#b0bec5;}
        .rl-val{font-size:clamp(10px,1.5vw,13px);font-weight:700;color:#fff;white-space:nowrap;margin-top:2px;}

        .pf-live-badge{display:inline-block;padding:2px 10px;border-radius:10px;font-size:10px;font-weight:700;letter-spacing:1px;}
        .pf-live{background:rgba(0,230,118,0.1);color:#00e676;border:1px solid rgba(0,230,118,0.3);}
        .pf-estimated{background:rgba(255,138,101,0.1);color:#ff8a65;border:1px solid rgba(255,138,101,0.3);}
        .pf-date-range{font-size:11px;color:#80deea;font-weight:400;letter-spacing:1px;}
        .pf-grid{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:14px;margin-bottom:18px;}
        .pf-card{background:rgba(255,255,255,0.03);border:1px solid rgba(0,212,255,0.18);border-radius:16px;padding:16px 14px 14px;display:flex;flex-direction:column;gap:12px;position:relative;overflow:hidden;transition:all 0.25s cubic-bezier(0.4,0,0.2,1);min-width:0;}
        .pf-card:hover{background:rgba(255,255,255,0.06);transform:translateY(-3px);box-shadow:0 12px 32px rgba(0,0,0,0.35);}
        .pf-card-topline{position:absolute;top:0;left:0;right:0;height:1px;}
        .pf-card-head{display:flex;justify-content:space-between;align-items:baseline;}
        .pf-card-date{font-family:'Oxanium',sans-serif;font-size:clamp(10px,1.5vw,12px);font-weight:700;color:#e0f7fa;letter-spacing:1px;}
        .pf-card-day{font-size:9px;letter-spacing:1.5px;color:rgba(128,222,234,0.3);text-transform:uppercase;}
        .pf-block{display:flex;flex-direction:column;gap:5px;}
        .pf-block-header{display:flex;justify-content:space-between;align-items:baseline;}
        .pf-block-lbl{font-size:8px;font-weight:700;letter-spacing:2px;text-transform:uppercase;}
        .pf-fii-lbl{color:rgba(0,212,255,0.5);} .pf-dii-lbl{color:rgba(255,179,0,0.5);}
        .pf-block-val{font-family:'JetBrains Mono',monospace;font-size:clamp(12px,1.8vw,15px);font-weight:700;line-height:1;word-break:break-all;}
        .pf-bar-track{height:4px;background:rgba(0,0,0,0.35);border-radius:2px;overflow:hidden;}
        .pf-bar-fill{height:100%;border-radius:2px;transition:width 1.2s cubic-bezier(0.4,0,0.2,1);}
        .pf-divider{height:1px;background:rgba(255,255,255,0.04);margin:0 -2px;}
        .pf-card-net{display:flex;justify-content:space-between;align-items:baseline;padding-top:8px;border-top:1px solid rgba(255,255,255,0.05);margin-top:auto;}
        .pf-net-lbl{font-size:8px;letter-spacing:2px;color:rgba(255,255,255,0.2);text-transform:uppercase;font-weight:700;}
        .pf-net-val{font-family:'JetBrains Mono',monospace;font-size:clamp(11px,1.5vw,13px);font-weight:700;word-break:break-all;}
        .pf-avg-strip{display:grid;grid-template-columns:1fr auto 1fr auto 1fr;align-items:center;background:rgba(6,13,20,0.75);border:1px solid rgba(79,195,247,0.1);border-radius:14px;padding:18px 24px;margin-bottom:16px;}
        .pf-avg-cell{text-align:center;min-width:0;}
        .pf-avg-eyebrow{font-size:8px;letter-spacing:2.5px;color:rgba(0,229,255,0.4);text-transform:uppercase;margin-bottom:6px;font-weight:700;}
        .pf-avg-val{font-family:'Oxanium',sans-serif;font-size:clamp(18px,3vw,26px);font-weight:800;line-height:1;letter-spacing:-0.5px;word-break:break-word;}
        .pf-avg-unit{font-size:9px;color:#37474f;margin-top:3px;letter-spacing:1px;}
        .pf-avg-sep{width:1px;height:48px;background:linear-gradient(180deg,transparent,rgba(79,195,247,0.2),transparent);margin:0 16px;flex-shrink:0;}
        .pf-insight-box{border-radius:12px;padding:16px 18px;}
        .pf-insight-header{display:flex;align-items:center;gap:10px;margin-bottom:10px;flex-wrap:wrap;}
        .pf-insight-lbl{font-size:9px;letter-spacing:2px;font-weight:700;text-transform:uppercase;}
        .pf-verdict-badge{display:inline-block;padding:3px 14px;border-radius:20px;font-size:clamp(10px,1.5vw,11px);font-weight:800;letter-spacing:1px;white-space:nowrap;}
        .pf-insight-text{font-size:clamp(12px,1.5vw,13px);color:#cfd8dc;line-height:1.85;font-weight:500;}

        .nc-section-header{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;margin-bottom:18px;padding-bottom:14px;border-bottom:1px solid rgba(79,195,247,0.14);}
        .nc-header-left{display:flex;align-items:center;gap:14px;}
        .nc-header-icon{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#1e3a5f,#1a3052);border:1px solid rgba(79,195,247,0.3);display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;box-shadow:0 4px 14px rgba(79,195,247,0.15);}
        .nc-header-title{font-family:'Outfit',sans-serif;font-size:clamp(13px,2vw,17px);font-weight:700;color:#93c5fd;letter-spacing:0.3px;}
        .nc-header-sub{font-family:'Outfit',sans-serif;font-size:11px;font-weight:400;color:rgba(79,195,247,0.45);margin-top:2px;letter-spacing:0.5px;}
        .nc-atm-badge{background:#1f2a42;color:#60a5fa;font-family:'Outfit',sans-serif;font-size:12px;font-weight:700;padding:6px 16px;border-radius:20px;letter-spacing:1.5px;border:1px solid rgba(96,165,250,0.25);box-shadow:0 2px 10px rgba(96,165,250,0.1);white-space:nowrap;}
        .nc-dir-box{border-radius:14px;padding:clamp(14px,2vw,20px) clamp(14px,2vw,22px);margin-bottom:18px;box-shadow:0 4px 24px rgba(0,0,0,0.3);}
        .nc-dir-bar{width:4px;border-radius:2px;flex-shrink:0;min-height:60px;}
        .nc-dir-tag{font-family:'Outfit',sans-serif;font-size:9px;font-weight:700;letter-spacing:2.5px;color:rgba(148,163,184,0.5);text-transform:uppercase;margin-bottom:6px;}
        .nc-dir-name{font-family:'Outfit',sans-serif;font-size:clamp(18px,3vw,28px);font-weight:700;line-height:1;margin-bottom:6px;letter-spacing:-0.5px;}
        .nc-dir-signal{font-family:'Outfit',sans-serif;font-size:clamp(10px,1.3vw,12px);font-weight:400;}
        .nc-meters-panel{display:flex;flex-direction:column;gap:14px;min-width:180px;justify-content:center;}
        .nc-meter-row{display:flex;flex-direction:column;gap:5px;}
        .nc-meter-head-row{display:flex;justify-content:space-between;align-items:center;}
        .nc-meter-label{font-family:'Outfit',sans-serif;font-size:9px;font-weight:700;letter-spacing:2px;color:rgba(148,163,184,0.45);text-transform:uppercase;}
        .nc-meter-track{position:relative;height:8px;background:rgba(0,0,0,0.4);border-radius:4px;overflow:visible;width:clamp(120px,20vw,200px);}
        .nc-meter-fill{height:100%;border-radius:4px;}
        .nc-meter-head{position:absolute;top:50%;transform:translate(-50%,-50%);width:14px;height:14px;border-radius:50%;border:2px solid rgba(10,18,30,0.85);}
        .nc-meter-pct{font-family:'Oxanium',sans-serif;font-size:clamp(12px,1.8vw,15px);font-weight:700;letter-spacing:0.5px;}
        .nc-cards-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:14px;}
        .nc-card{background:rgba(20,28,45,0.85);border:1px solid rgba(79,195,247,0.12);border-radius:14px;padding:clamp(12px,2vw,18px) clamp(12px,2vw,18px) 14px;transition:all 0.3s ease;position:relative;overflow:hidden;min-width:0;}
        .nc-card::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.1),transparent);}
        .nc-card:hover{border-color:rgba(79,195,247,0.3);background:rgba(25,35,55,0.9);transform:translateY(-3px);box-shadow:0 10px 30px rgba(0,0,0,0.3);}
        .nc-card-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;flex-wrap:wrap;gap:4px;}
        .nc-card-label{font-family:'Outfit',sans-serif;font-size:clamp(8px,1.2vw,10px);font-weight:700;letter-spacing:2px;color:rgba(148,163,184,0.6);text-transform:uppercase;}
        .nc-card-value{font-family:'Oxanium',sans-serif;font-size:clamp(20px,3.5vw,30px);font-weight:700;line-height:1;margin-bottom:6px;letter-spacing:-0.5px;word-break:break-word;}
        .nc-card-sub{font-family:'JetBrains Mono',monospace;font-size:10px;color:rgba(100,116,139,0.7);margin-bottom:14px;}
        .nc-card-btn{display:block;width:100%;padding:9px 14px;border-radius:7px;text-align:center;font-family:'Outfit',sans-serif;font-size:clamp(11px,1.5vw,13px);font-weight:700;letter-spacing:0.5px;cursor:default;}

        /* ‚ïê‚ïê STRATEGY CHECKLIST ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .annot-badge{font-size:9px;padding:2px 10px;border-radius:8px;background:rgba(0,230,118,0.1);border:1px solid rgba(0,230,118,0.25);color:#00e676;font-family:'JetBrains Mono',monospace;letter-spacing:1px;font-weight:700;white-space:nowrap;}
        .input-summary-grid{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:12px;margin-bottom:20px;}
        .inp-summary-card{border-radius:12px;padding:14px 16px;border:1px solid;transition:all 0.2s ease;}
        .inp-auto-card{background:rgba(0,230,118,0.04);border-color:rgba(0,230,118,0.2);}
        .inp-manual-card{background:rgba(79,195,247,0.04);border-color:rgba(79,195,247,0.15);}
        .inp-s-label{font-size:9px;letter-spacing:2px;text-transform:uppercase;font-weight:700;margin-bottom:6px;}
        .inp-auto-card .inp-s-label{color:rgba(0,230,118,0.5);}
        .inp-manual-card .inp-s-label{color:rgba(79,195,247,0.5);}
        .inp-s-val{font-family:'Oxanium',sans-serif;font-size:clamp(14px,2vw,18px);font-weight:700;color:#e0f7fa;margin-bottom:4px;line-height:1.2;}
        .inp-s-src{font-size:9px;font-family:'JetBrains Mono',monospace;}
        .inp-auto-card .inp-s-src{color:rgba(0,230,118,0.3);}
        .inp-manual-card .inp-s-src{color:rgba(79,195,247,0.3);}
        .na-inline{color:rgba(176,190,197,0.3);font-family:'JetBrains Mono',monospace;font-size:13px;}
        .signal-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;margin-bottom:20px;}
        .sig-card{background:rgba(255,255,255,0.03);border:1px solid rgba(79,195,247,0.12);border-radius:12px;padding:14px 16px;display:flex;align-items:flex-start;gap:14px;}
        .sig-icon{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;}
        .sig-bull{background:rgba(0,230,118,0.1);border:1px solid rgba(0,230,118,0.25);}
        .sig-bear{background:rgba(255,82,82,0.1);border:1px solid rgba(255,82,82,0.25);}
        .sig-neu{background:rgba(255,183,77,0.1);border:1px solid rgba(255,183,77,0.25);}
        .sig-na{background:rgba(176,190,197,0.06);border:1px solid rgba(176,190,197,0.12);}
        .sig-body{flex:1;min-width:0;}
        .sig-name{font-size:9px;letter-spacing:1.5px;color:rgba(128,222,234,0.5);text-transform:uppercase;font-weight:700;margin-bottom:4px;display:flex;align-items:center;gap:6px;flex-wrap:wrap;}
        .sig-val{font-family:'Oxanium',sans-serif;font-size:15px;font-weight:700;color:#fff;margin-bottom:3px;}
        .sig-val.na-val{color:rgba(176,190,197,0.3);font-family:'JetBrains Mono',monospace;font-size:13px;}
        .sig-msg{font-size:11px;color:rgba(176,190,197,0.55);line-height:1.5;}
        .sig-score{font-family:'JetBrains Mono',monospace;font-size:13px;font-weight:700;padding:3px 9px;border-radius:6px;flex-shrink:0;margin-top:2px;}
        .score-p{background:rgba(0,230,118,0.12);color:#00e676;border:1px solid rgba(0,230,118,0.3);}
        .score-n{background:rgba(255,82,82,0.12);color:#ff5252;border:1px solid rgba(255,82,82,0.3);}
        .score-0{background:rgba(255,183,77,0.1);color:#ffb74d;border:1px solid rgba(255,183,77,0.25);}
        .score-na{background:rgba(176,190,197,0.08);color:rgba(176,190,197,0.35);border:1px solid rgba(176,190,197,0.12);}
        .auto-badge{font-size:8px;padding:1px 6px;border-radius:4px;background:rgba(0,230,118,0.1);border:1px solid rgba(0,230,118,0.25);color:#00e676;font-weight:700;letter-spacing:0.5px;}
        .manual-badge{font-size:8px;padding:1px 6px;border-radius:4px;background:rgba(79,195,247,0.08);border:1px solid rgba(79,195,247,0.2);color:#4fc3f7;font-weight:700;letter-spacing:0.5px;}
        .score-meter{background:rgba(10,20,30,0.7);border:1px solid rgba(79,195,247,0.15);border-radius:16px;padding:22px 24px;display:flex;align-items:center;gap:24px;flex-wrap:wrap;}
        .score-ring-wrap{position:relative;flex-shrink:0;width:120px;height:120px;}
        .score-ring-label{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;}
        .score-ring-num{font-family:'Orbitron',monospace;font-size:26px;font-weight:900;line-height:1;}
        .score-ring-txt{font-size:8px;letter-spacing:2px;color:rgba(176,190,197,0.4);text-transform:uppercase;}
        .score-detail{flex:1;min-width:200px;}
        .score-bias-lbl{font-family:'Orbitron',monospace;font-size:clamp(16px,3vw,24px);font-weight:900;letter-spacing:2px;margin-bottom:8px;}
        .score-sub{font-size:12px;color:rgba(176,190,197,0.5);line-height:1.6;margin-bottom:8px;}
        .score-pills{display:flex;gap:8px;flex-wrap:wrap;}
        .sc-pill{font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:700;padding:4px 12px;border-radius:20px;letter-spacing:1px;}
        .sc-pill-bull{background:rgba(0,230,118,0.1);border:1px solid rgba(0,230,118,0.3);color:#00e676;}
        .sc-pill-bear{background:rgba(255,82,82,0.1);border:1px solid rgba(255,82,82,0.3);color:#ff5252;}
        .sc-pill-neu{background:rgba(255,183,77,0.1);border:1px solid rgba(255,183,77,0.3);color:#ffb74d;}
        .sc-pill-na{background:rgba(176,190,197,0.06);border:1px solid rgba(176,190,197,0.15);color:rgba(176,190,197,0.4);}
        .strat-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px;}
        .strat-card{background:rgba(255,255,255,0.03);border:1px solid rgba(79,195,247,0.12);border-radius:14px;padding:16px;position:relative;overflow:hidden;transition:all 0.25s ease;}
        .strat-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;}
        .strat-bull::before{background:linear-gradient(90deg,transparent,#00e676,transparent);}
        .strat-bear::before{background:linear-gradient(90deg,transparent,#ff5252,transparent);}
        .strat-neu::before{background:linear-gradient(90deg,transparent,#ffb74d,transparent);}
        .strat-vol::before{background:linear-gradient(90deg,transparent,#7c4dff,transparent);}
        .strat-misc::before{background:linear-gradient(90deg,transparent,#4fc3f7,transparent);}
        .strat-card:hover{transform:translateY(-3px);box-shadow:0 12px 30px rgba(0,0,0,0.3);border-color:rgba(79,195,247,0.3);}
        .strat-num{font-family:'JetBrains Mono',monospace;font-size:9px;color:rgba(176,190,197,0.25);margin-bottom:6px;letter-spacing:1px;}
        .strat-name{font-family:'Oxanium',sans-serif;font-size:clamp(12px,1.5vw,15px);font-weight:700;color:#e0f7fa;margin-bottom:8px;line-height:1.3;}
        .strat-tag{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:20px;font-size:9px;font-weight:700;letter-spacing:1px;}
        .strat-tag-bull{background:rgba(0,230,118,0.1);border:1px solid rgba(0,230,118,0.25);color:#00e676;}
        .strat-tag-bear{background:rgba(255,82,82,0.1);border:1px solid rgba(255,82,82,0.25);color:#ff5252;}
        .strat-tag-neu{background:rgba(255,183,77,0.1);border:1px solid rgba(255,183,77,0.25);color:#ffb74d;}
        .strat-tag-vol{background:rgba(124,77,255,0.1);border:1px solid rgba(124,77,255,0.25);color:#b388ff;}
        .strat-tag-misc{background:rgba(79,195,247,0.1);border:1px solid rgba(79,195,247,0.25);color:#4fc3f7;}
        .filter-btn{padding:6px 14px;border-radius:20px;font-size:10px;font-weight:700;letter-spacing:1px;cursor:pointer;border:1px solid rgba(79,195,247,0.2);background:transparent;color:rgba(176,190,197,0.5);transition:all 0.2s ease;font-family:'Oxanium',sans-serif;}
        .filter-btn.active,.filter-btn:hover{background:rgba(79,195,247,0.1);border-color:rgba(79,195,247,0.4);color:#4fc3f7;}

        /* ‚ïê‚ïê INTRADAY OI TREND ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .oi-controls{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;margin-bottom:20px;}
        .oi-interval-btns{display:flex;gap:0;border:1px solid rgba(79,195,247,0.25);border-radius:10px;overflow:hidden;}
        .oi-int-btn{padding:9px 24px;font-family:'Oxanium',sans-serif;font-size:12px;font-weight:700;letter-spacing:2px;color:rgba(176,190,197,0.5);background:transparent;border:none;cursor:pointer;transition:all 0.2s ease;border-right:1px solid rgba(79,195,247,0.15);}
        .oi-int-btn:last-child{border-right:none;}
        .oi-int-btn:hover{background:rgba(79,195,247,0.12);color:#4fc3f7;}
        .oi-int-btn.active{background:rgba(79,195,247,0.22);color:#00e5ff;box-shadow:inset 0 0 12px rgba(79,195,247,0.1);}
        .oi-live-badge{display:flex;align-items:center;gap:7px;font-family:'JetBrains Mono',monospace;font-size:10px;letter-spacing:2px;color:rgba(0,230,118,0.7);background:rgba(0,230,118,0.08);border:1px solid rgba(0,230,118,0.25);padding:6px 14px;border-radius:8px;}
        .oi-live-dot{width:7px;height:7px;border-radius:50%;background:#00e676;box-shadow:0 0 8px #00e676;animation:sb-pulse 1.5s ease-in-out infinite;}
        .oi-summary-strip{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:12px;margin-bottom:20px;}
        .oi-sum-card{background:rgba(255,255,255,0.03);border:1px solid rgba(79,195,247,0.14);border-radius:12px;padding:14px 16px;text-align:center;}
        .oi-sum-label{font-size:9px;letter-spacing:2px;color:rgba(128,222,234,0.4);text-transform:uppercase;font-weight:700;margin-bottom:6px;}
        .oi-sum-val{font-family:'Oxanium',sans-serif;font-size:clamp(16px,2.5vw,22px);font-weight:700;line-height:1;}
        .oi-chart-wrap{background:rgba(6,13,20,0.7);border:1px solid rgba(79,195,247,0.14);border-radius:14px;padding:16px;margin-bottom:20px;}
        .oi-chart-label{font-size:9px;letter-spacing:2px;color:rgba(128,222,234,0.4);text-transform:uppercase;font-weight:700;}
        .oi-table-wrap{background:rgba(6,13,20,0.7);border:1px solid rgba(79,195,247,0.14);border-radius:14px;overflow:hidden;}
        .oi-table{width:100%;border-collapse:collapse;font-family:'JetBrains Mono',monospace;}
        .oi-table thead th{padding:11px 14px;font-size:9px;letter-spacing:2px;color:rgba(128,222,234,0.45);text-transform:uppercase;font-weight:700;text-align:right;border-bottom:1px solid rgba(79,195,247,0.15);background:rgba(79,195,247,0.05);white-space:nowrap;}
        .oi-table thead th:first-child{text-align:left;}
        .oi-table tbody tr{border-bottom:1px solid rgba(79,195,247,0.06);transition:background 0.15s ease;}
        .oi-table tbody tr:hover{background:rgba(79,195,247,0.05);}
        .oi-table tbody tr.oi-live-row{background:rgba(0,230,118,0.05);border-left:3px solid rgba(0,230,118,0.5);}
        .oi-table tbody td{padding:10px 14px;font-size:clamp(11px,1.4vw,13px);text-align:right;color:#b0bec5;white-space:nowrap;}
        .oi-table tbody td:first-child{text-align:left;color:#e0f7fa;font-weight:700;}
        .oi-time-cell{display:flex;align-items:center;gap:8px;}
        .oi-live-ind{display:inline-flex;align-items:center;gap:4px;font-size:9px;color:#00e676;letter-spacing:1px;font-weight:700;}
        .oi-live-ind::before{content:'';display:inline-block;width:5px;height:5px;border-radius:50%;background:#00e676;box-shadow:0 0 5px #00e676;animation:sb-pulse 1.5s ease-in-out infinite;}
        .oi-call-val{color:#fb7185;}
        .oi-put-val{color:#34d399;}
        .oi-diff-neg{color:#fb7185;font-weight:700;}
        .oi-diff-pos{color:#34d399;font-weight:700;}
        .oi-pcr-val{color:#fbbf24;}
        .oi-signal-ssell{display:inline-block;padding:3px 10px;border-radius:6px;font-size:10px;font-weight:700;letter-spacing:1px;background:rgba(220,38,38,0.2);color:#fca5a5;border:1px solid rgba(220,38,38,0.4);}
        .oi-signal-sell{display:inline-block;padding:3px 10px;border-radius:6px;font-size:10px;font-weight:700;letter-spacing:1px;background:rgba(239,68,68,0.15);color:#f87171;border:1px solid rgba(239,68,68,0.3);}
        .oi-signal-sbuy{display:inline-block;padding:3px 10px;border-radius:6px;font-size:10px;font-weight:700;letter-spacing:1px;background:rgba(5,150,105,0.2);color:#a7f3d0;border:1px solid rgba(5,150,105,0.4);}
        .oi-signal-buy{display:inline-block;padding:3px 10px;border-radius:6px;font-size:10px;font-weight:700;letter-spacing:1px;background:rgba(16,185,129,0.15);color:#6ee7b7;border:1px solid rgba(16,185,129,0.3);}
        .oi-signal-neutral{display:inline-block;padding:3px 10px;border-radius:6px;font-size:10px;font-weight:700;letter-spacing:1px;background:rgba(245,158,11,0.12);color:#fde68a;border:1px solid rgba(245,158,11,0.25);}
        .oi-vwap-cell{color:#93c5fd;font-weight:600;}
        .oi-fut-cell{color:#c4b5fd;}
        .oi-spot-cell{color:#e0f7fa;font-weight:700;}
        .oi-vsig-sell{display:inline-block;padding:2px 8px;border-radius:5px;font-size:9px;font-weight:700;background:rgba(239,68,68,0.12);color:#fca5a5;border:1px solid rgba(239,68,68,0.25);}
        .oi-vsig-buy{display:inline-block;padding:2px 8px;border-radius:5px;font-size:9px;font-weight:700;background:rgba(16,185,129,0.12);color:#6ee7b7;border:1px solid rgba(16,185,129,0.25);}
        .oi-empty-state{text-align:center;padding:60px 20px;color:rgba(176,190,197,0.3);font-family:'JetBrains Mono',monospace;font-size:13px;}

        .disclaimer{background:rgba(255,183,77,0.1);backdrop-filter:blur(8px);padding:22px;border-radius:12px;border-left:4px solid #ffb74d;font-size:clamp(11px,1.5vw,13px);color:#ffb74d;line-height:1.8;}
        .footer{text-align:center;padding:24px;color:#546e7a;font-size:clamp(10px,1.3vw,12px);background:rgba(10,20,28,0.4);}

        @media(max-width:1024px){
            .grid-5{grid-template-columns:repeat(3,minmax(0,1fr));}
            .grid-4{grid-template-columns:repeat(2,minmax(0,1fr));}
            .pf-grid{grid-template-columns:repeat(3,minmax(0,1fr));gap:10px;}
            .nc-cards-grid{grid-template-columns:repeat(3,minmax(0,1fr));}
            .nc-meter-track{width:140px;}
            .input-summary-grid{grid-template-columns:repeat(3,minmax(0,1fr));}
            .oi-summary-strip{grid-template-columns:repeat(2,minmax(0,1fr));}
        }
        @media(max-width:600px){
            .grid-5,.grid-4{grid-template-columns:minmax(0,1fr);}
            .snap-grid{grid-template-columns:repeat(2,minmax(0,1fr));}
            .logic-grid{grid-template-columns:1fr;}
            .pf-grid{grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;}
            .nc-cards-grid{grid-template-columns:minmax(0,1fr);}
            .nc-section-header{flex-direction:column;align-items:flex-start;}
            .nc-atm-badge{align-self:flex-end;}
            .nc-dir-name{font-size:clamp(18px,5vw,24px);}
            .nc-meters-panel{min-width:unset;width:100%;}
            .nc-meter-track{width:100%;max-width:280px;}
            .pf-avg-strip{grid-template-columns:1fr;gap:0;padding:14px;}
            .pf-avg-sep{display:none;}
            .pf-avg-cell{text-align:left;display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 0;border-bottom:1px solid rgba(79,195,247,0.07);}
            .pf-avg-cell:last-child{border-bottom:none;}
            .pf-avg-eyebrow{margin-bottom:0;}
            .md-direction{font-size:clamp(20px,6vw,28px);}
            .md-row-top,.md-row-bottom{flex-direction:column;align-items:flex-start;}
            div[style*="grid-template-columns:1fr 1fr"]{grid-template-columns:1fr !important;}
            .status-bar{flex-wrap:wrap;}
            .sb-item{flex:1 1 45%;border-right:none;border-bottom:1px solid rgba(79,195,247,0.08);}
            .sb-item:nth-child(odd){border-right:1px solid rgba(79,195,247,0.08);}
            .sb-item:last-child,.sb-item:nth-last-child(-n+2):nth-child(odd){border-bottom:none;}
            .pf-date-range{display:none;}
            .signal-grid{grid-template-columns:1fr;}
            .strat-grid{grid-template-columns:1fr;}
            .input-summary-grid{grid-template-columns:repeat(2,minmax(0,1fr));}
            .score-meter{flex-direction:column;}
            .oi-summary-strip{grid-template-columns:1fr 1fr;}
            .oi-table thead th,.oi-table tbody td{padding:8px 8px;font-size:10px;}
            .oi-int-btn{padding:8px 14px;font-size:10px;}
        }
        @media(max-width:400px){
            .snap-grid{grid-template-columns:minmax(0,1fr);}
            .pf-grid{grid-template-columns:minmax(0,1fr);}
            .header h1{letter-spacing:0;}
            .input-summary-grid{grid-template-columns:1fr;}
            .oi-summary-strip{grid-template-columns:1fr;}
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>&#128202; NIFTY 50 DAILY REPORT</h1>
        <div class="status-bar">
            <div class="sb-item">
                <span class="sb-dot sb-dot-gen"></span>
                <span class="sb-label">Generated</span>
                <span class="sb-value gen-val">25-Feb-2026 10:20 IST</span>
            </div>
            <div class="sb-item">
                <span class="sb-dot sb-dot-clock"></span>
                <span class="sb-label">IST Now</span>
                <span class="sb-value clock-val" id="live-ist-clock">--:--:--</span>
            </div>
            <div class="sb-item">
                <span class="sb-dot sb-dot-updated"></span>
                <span class="sb-label">Last Updated</span>
                <span class="sb-value updated-val" id="last-updated">25-Feb-2026 10:20 IST</span>
            </div>
            <div class="sb-item">
                <span class="sb-dot sb-dot-cd"></span>
                <span class="sb-label">Next Refresh</span>
                <span class="sb-value cd-val" id="refresh-countdown">30s</span>
            </div>
        </div>
        <div class="tab-nav" id="tabNav">
            <button class="tab-btn active" data-tab="main" onclick="switchTab('main')">
                <span class="tab-dot"></span> &#128200; Main Analysis <span class="tab-badge">LIVE</span>
            </button>
            <button class="tab-btn" data-tab="oi-trend" onclick="switchTab('oi-trend')">
                <span class="tab-dot"></span> &#128202; Intraday OI Trend <span class="tab-badge">IST</span>
            </button>
            <button class="tab-btn new-badge" data-tab="checklist" onclick="switchTab('checklist')">
                <span class="tab-dot"></span> &#129504; Strategy Checklist <span class="tab-badge">NEW</span>
            </button>
        </div>
    </div>

    <!-- TAB 1: MAIN ANALYSIS -->
    <div class="tab-panel active" id="tab-main">
        <div class="section">
            <div class="section-title"><span>&#128200;</span> MARKET SNAPSHOT</div>
            <div class="snap-grid">
                <div class="g snap-card g-hi"><div class="card-top-row"><span class="card-ico">&#128185;</span><div class="lbl">NIFTY 50 SPOT</div></div><span class="val">&#8377;25,639.20</span></div>
                <div class="g snap-card"><div class="card-top-row"><span class="card-ico">&#127919;</span><div class="lbl">ATM STRIKE</div></div><span class="val">&#8377;25,650</span></div>
                <div class="g snap-card"><div class="card-top-row"><span class="card-ico">&#128197;</span><div class="lbl">EXPIRY DATE</div></div><span class="val" style="font-size:20px">02-Mar-2026</span></div>
            </div>
        </div>

<div class="section">
    <div class="nc-section-header">
        <div class="nc-header-left"><div class="nc-header-icon">üìä</div>
        <div><div class="nc-header-title">Change in Open Interest</div>
        <div class="nc-header-sub">Today's Direction Analysis</div></div></div>
        <div class="nc-atm-badge">ATM ¬±10</div>
    </div>
    <div class="nc-dir-box" style="background:rgba(10,30,20,0.92);border:1px solid rgba(16,185,129,0.35);">
        <div style="display:flex;align-items:stretch;gap:18px;">
            <div class="nc-dir-bar" style="background:linear-gradient(180deg,#10b981,#047857);"></div>
            <div style="flex:1;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
                <div>
                    <div class="nc-dir-tag">MARKET DIRECTION</div>
                    <div class="nc-dir-name" style="color:#34d399;">Bullish</div>
                    <div class="nc-dir-signal" style="color:rgba(52,211,153,0.5);">Put Build-up Dominant</div>
                </div>
                <div class="nc-meters-panel"><div class="nc-meter-row"><div class="nc-meter-head-row"><span class="nc-meter-label">üü¢ Bull Strength</span><span class="nc-meter-pct" style="color:#34d399;">74%</span></div><div class="nc-meter-track"><div class="nc-meter-fill" style="width:74%;background:linear-gradient(90deg,#10b981,#34d399);"></div><div class="nc-meter-head" style="left:74%;background:#34d399;box-shadow:0 0 8px #34d399;"></div></div></div><div class="nc-meter-row"><div class="nc-meter-head-row"><span class="nc-meter-label">üî¥ Bear Strength</span><span class="nc-meter-pct" style="color:#fb7185;">26%</span></div><div class="nc-meter-track"><div class="nc-meter-fill" style="width:26%;background:linear-gradient(90deg,#ef4444,#f97316);"></div><div class="nc-meter-head" style="left:26%;background:#fb7185;box-shadow:0 0 8px #fb7185;"></div></div></div></div>
            </div>
        </div>
    </div>
    <div class="nc-cards-grid"><div class="nc-card"><div class="nc-card-header"><span class="nc-card-label">CALL OI CHANGE</span><span style="font-size:18px;line-height:1;color:#ef4444;">üî¥</span></div><div class="nc-card-value" style="color:#fb7185;">+240,576</div><div class="nc-card-sub">CE open interest Œî</div><div class="nc-card-btn" style="color:#ef4444;background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.4);">Bearish Signal</div></div><div class="nc-card"><div class="nc-card-header"><span class="nc-card-label">PUT OI CHANGE</span><span style="font-size:18px;line-height:1;color:#10b981;">üü¢</span></div><div class="nc-card-value" style="color:#34d399;">+686,934</div><div class="nc-card-sub">PE open interest Œî</div><div class="nc-card-btn" style="color:#10b981;background:rgba(16,185,129,0.12);border:1px solid rgba(16,185,129,0.4);">Bullish Signal</div></div><div class="nc-card"><div class="nc-card-header"><span class="nc-card-label">NET OI CHANGE</span><span style="font-size:18px;line-height:1;color:#10b981;">‚öñÔ∏è</span></div><div class="nc-card-value" style="color:#34d399;">+446,358</div><div class="nc-card-sub">PE Œî ‚àí CE Œî</div><div class="nc-card-btn" style="color:#10b981;background:rgba(16,185,129,0.12);border:1px solid rgba(16,185,129,0.4);">Bullish Net</div></div></div>
    <div class="logic-box" style="margin-top:16px;">
        <div class="logic-box-head">üìñ HOW TO READ</div>
        <div class="logic-grid">
            <div class="logic-item"><span class="lc-info">Call OI +</span> Writers selling calls <span class="lc-bear">Bearish</span>&nbsp;&nbsp;<span class="lc-info">Call OI ‚àí</span> Unwinding <span class="lc-bull">Bullish</span></div>
            <div class="logic-item"><span class="lc-info">Put OI +</span> Writers selling puts <span class="lc-bull">Bullish</span>&nbsp;&nbsp;<span class="lc-info">Put OI ‚àí</span> Unwinding <span class="lc-bear">Bearish</span></div>
            <div class="logic-item"><span class="lc-info">Net OI</span> = PE Œî ‚àí CE Œî &nbsp;¬∑&nbsp; <span class="lc-bull">Positive = Bullish</span> &nbsp;<span class="lc-bear">Negative = Bearish</span></div>
            <div class="logic-item"><span class="lc-info">Bull % + Bear %</span> = 100% &nbsp;¬∑&nbsp; relative dominance</div>
        </div>
    </div>
</div>

    <div class="section">
        <div class="section-title"><span>&#128202;</span> KEY LEVELS</div>
        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
            <span style="font-size:11px;color:#26c6da;font-weight:700;letter-spacing:1px;">&#9668; SUPPORT ZONE</span>
            <span style="font-size:11px;color:#f44336;font-weight:700;letter-spacing:1px;">RESISTANCE ZONE &#9658;</span>
        </div>
        <div style="position:relative;height:62px;">
            <div class="rl-node-a" style="left:3%;"><div class="rl-lbl" style="color:#26c6da;">Strong<br>Support</div><div class="rl-val" style="color:#26c6da;">&#8377;25,500</div><div class="rl-dot" style="background:#26c6da;margin:6px auto 0;"></div></div>
            <div class="rl-node-a" style="left:22%;"><div class="rl-lbl" style="color:#00bcd4;">Support</div><div class="rl-val" style="color:#00bcd4;">&#8377;25,575</div><div class="rl-dot" style="background:#00bcd4;box-shadow:0 0 8px #00bcd4;margin:6px auto 0;"></div></div>
            <div style="position:absolute;left:46.4%;transform:translateX(-50%);bottom:4px;background:#4fc3f7;color:#000;font-size:11px;font-weight:700;padding:4px 13px;border-radius:6px;white-space:nowrap;z-index:10;box-shadow:0 0 16px rgba(79,195,247,0.7);">&#9660; NOW &nbsp;&#8377;25,639</div>
            <div class="rl-node-a" style="left:75%;"><div class="rl-lbl" style="color:#ff7043;">Resistance</div><div class="rl-val" style="color:#ff7043;">&#8377;25,725</div><div class="rl-dot" style="background:#ff7043;box-shadow:0 0 8px #ff7043;margin:6px auto 0;"></div></div>
            <div class="rl-node-a" style="left:95%;"><div class="rl-lbl" style="color:#f44336;">Strong<br>Resistance</div><div class="rl-val" style="color:#f44336;">&#8377;25,800</div><div class="rl-dot" style="background:#f44336;margin:6px auto 0;"></div></div>
        </div>
        <div style="position:relative;height:8px;border-radius:4px;background:linear-gradient(90deg,#26c6da 0%,#00bcd4 20%,#4fc3f7 40%,#ffb74d 58%,#ff7043 76%,#f44336 100%);box-shadow:0 2px 14px rgba(0,0,0,0.5);">
            <div style="position:absolute;left:46.4%;top:50%;transform:translate(-50%,-50%);width:4px;height:22px;background:#fff;border-radius:2px;box-shadow:0 0 16px rgba(255,255,255,1);z-index:10;"></div>
        </div>
        <div style="position:relative;height:58px;"><div class="rl-node-b" style="left:43%;"><div class="rl-dot" style="background:#ffb74d;box-shadow:0 0 8px #ffb74d;margin:0 auto 5px;"></div><div class="rl-lbl" style="color:#ffb74d;">Max Pain</div><div class="rl-val" style="color:#ffb74d;">‚Çπ25,650</div></div></div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:4px;">
            <div style="background:rgba(244,67,54,0.08);border:1px solid rgba(244,67,54,0.25);border-radius:8px;padding:10px 16px;display:flex;justify-content:space-between;align-items:center;">
                <span style="font-size:12px;color:#b0bec5;">&#128205; Distance to Resistance</span>
                <span style="font-size:15px;font-weight:700;color:#f44336;">+85 pts</span>
            </div>
            <div style="background:rgba(0,188,212,0.08);border:1px solid rgba(0,188,212,0.25);border-radius:8px;padding:10px 16px;display:flex;justify-content:space-between;align-items:center;">
                <span style="font-size:12px;color:#b0bec5;">&#128205; Distance to Support</span>
                <span style="font-size:15px;font-weight:700;color:#00bcd4;">‚àí64 pts</span>
            </div>
        </div>
    </div>

<div class="section">
    <div class="section-title">
        <span>üè¶</span> FII / DII INSTITUTIONAL FLOW
        <span class="pf-live-badge pf-live">‚óè LIVE</span>
        <span class="pf-date-range">Last 5 Trading Days &nbsp;¬∑&nbsp; Feb 18 ‚Äì Feb 24</span>
    </div>
    <div class="pf-grid"><div class="pf-card" style="border-color:rgba(0,212,255,0.18);"><div class="pf-card-topline" style="background:linear-gradient(90deg,transparent,#00d4ff,transparent);"></div><div class="pf-card-head"><span class="pf-card-date">Feb 18</span><span class="pf-card-day">Wed</span></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-fii-lbl">FII</span><span class="pf-block-val" style="color:#00d4ff;">+1,154</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:33.1%;background:linear-gradient(90deg,#00d4ff,#0090ff);"></div></div></div><div class="pf-divider"></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-dii-lbl">DII</span><span class="pf-block-val" style="color:#ffb300;">+440</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:12.6%;background:linear-gradient(90deg,#ffb300,#ff8f00);"></div></div></div><div class="pf-card-net"><span class="pf-net-lbl">NET</span><span class="pf-net-val" style="color:#34d399;">+1,595</span></div></div><div class="pf-card" style="border-color:rgba(255,68,68,0.18);"><div class="pf-card-topline" style="background:linear-gradient(90deg,transparent,#ff4444,transparent);"></div><div class="pf-card-head"><span class="pf-card-date">Feb 19</span><span class="pf-card-day">Thu</span></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-fii-lbl">FII</span><span class="pf-block-val" style="color:#ff4444;">-880</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:25.3%;background:linear-gradient(90deg,#ff4444,#ff0055);"></div></div></div><div class="pf-divider"></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-dii-lbl">DII</span><span class="pf-block-val" style="color:#ff4444;">-596</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:17.1%;background:linear-gradient(90deg,#ff4444,#ff0055);"></div></div></div><div class="pf-card-net"><span class="pf-net-lbl">NET</span><span class="pf-net-val" style="color:#f87171;">-1,477</span></div></div><div class="pf-card" style="border-color:rgba(0,212,255,0.18);"><div class="pf-card-topline" style="background:linear-gradient(90deg,transparent,#00d4ff,transparent);"></div><div class="pf-card-head"><span class="pf-card-date">Feb 20</span><span class="pf-card-day">Fri</span></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-fii-lbl">FII</span><span class="pf-block-val" style="color:#ff4444;">-935</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:26.8%;background:linear-gradient(90deg,#ff4444,#ff0055);"></div></div></div><div class="pf-divider"></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-dii-lbl">DII</span><span class="pf-block-val" style="color:#ffb300;">+2,637</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:75.7%;background:linear-gradient(90deg,#ffb300,#ff8f00);"></div></div></div><div class="pf-card-net"><span class="pf-net-lbl">NET</span><span class="pf-net-val" style="color:#34d399;">+1,703</span></div></div><div class="pf-card" style="border-color:rgba(0,212,255,0.18);"><div class="pf-card-topline" style="background:linear-gradient(90deg,transparent,#00d4ff,transparent);"></div><div class="pf-card-head"><span class="pf-card-date">Feb 23</span><span class="pf-card-day">Mon</span></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-fii-lbl">FII</span><span class="pf-block-val" style="color:#00d4ff;">+3,484</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:100%;background:linear-gradient(90deg,#00d4ff,#0090ff);"></div></div></div><div class="pf-divider"></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-dii-lbl">DII</span><span class="pf-block-val" style="color:#ff4444;">-1,292</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:37.1%;background:linear-gradient(90deg,#ff4444,#ff0055);"></div></div></div><div class="pf-card-net"><span class="pf-net-lbl">NET</span><span class="pf-net-val" style="color:#34d399;">+2,191</span></div></div><div class="pf-card" style="border-color:rgba(0,212,255,0.18);"><div class="pf-card-topline" style="background:linear-gradient(90deg,transparent,#00d4ff,transparent);"></div><div class="pf-card-head"><span class="pf-card-date">Feb 24</span><span class="pf-card-day">Tue</span></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-fii-lbl">FII</span><span class="pf-block-val" style="color:#ff4444;">-103</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:2.9%;background:linear-gradient(90deg,#ff4444,#ff0055);"></div></div></div><div class="pf-divider"></div><div class="pf-block"><div class="pf-block-header"><span class="pf-block-lbl pf-dii-lbl">DII</span><span class="pf-block-val" style="color:#ffb300;">+3,161</span></div><div class="pf-bar-track"><div class="pf-bar-fill" style="width:90.7%;background:linear-gradient(90deg,#ffb300,#ff8f00);"></div></div></div><div class="pf-card-net"><span class="pf-net-lbl">NET</span><span class="pf-net-val" style="color:#34d399;">+3,059</span></div></div></div>
    <div class="pf-avg-strip">
        <div class="pf-avg-cell"><div class="pf-avg-eyebrow">FII 5D Avg</div><div class="pf-avg-val" style="color:#00d4ff;">+544</div><div class="pf-avg-unit">&#8377; Cr / day</div></div>
        <div class="pf-avg-sep"></div>
        <div class="pf-avg-cell"><div class="pf-avg-eyebrow">DII 5D Avg</div><div class="pf-avg-val" style="color:#ffb300;">+870</div><div class="pf-avg-unit">&#8377; Cr / day</div></div>
        <div class="pf-avg-sep"></div>
        <div class="pf-avg-cell"><div class="pf-avg-eyebrow">Net Combined</div><div class="pf-avg-val" style="color:#c084fc;">+1,414</div><div class="pf-avg-unit">&#8377; Cr / day</div></div>
    </div>
    <div class="pf-insight-box" style="background:rgba(0,230,118,0.12);border:1px solid rgba(0,230,118,0.3);">
        <div class="pf-insight-header"><span class="pf-insight-lbl" style="color:#00e676;">&#128202; 5-DAY INSIGHT &amp; DIRECTION</span><span class="pf-verdict-badge" style="color:#00e676;background:rgba(0,230,118,0.12);border:1px solid rgba(0,230,118,0.3);">üöÄ STRONGLY BULLISH</span></div>
        <div class="pf-insight-text">Both FIIs (avg <span style="color:#00e676;font-weight:700;">‚Çπ+544 Cr/day</span>) and DIIs (avg <span style="color:#40c4ff;font-weight:700;">‚Çπ+870 Cr/day</span>) are net buyers ‚Äî strong dual institutional confirmation. Net combined flow: <span style="color:#b388ff;font-weight:700;">‚Çπ+1414 Cr/day</span>.</div>
    </div>
</div>

    <div class="section">
        <div class="section-title"><span>&#129517;</span> MARKET DIRECTION (Algorithmic)</div>
        <div class="md-widget">
            <div class="md-glow"></div>
            <div class="md-row-top">
                <div class="md-label"><div class="md-live-dot"></div>MARKET DIRECTION &nbsp;¬∑&nbsp; ALGORITHMIC</div>
                <div class="md-pills-top"><span class="md-pill md-pill-bull">BULL 2</span><span class="md-pill md-pill-bear">BEAR 2</span></div>
            </div>
            <div class="md-row-bottom">
                <div class="md-direction" style="background:linear-gradient(135deg, #ffcd3c, #f7931e);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">SIDEWAYS</div>
                <span class="md-pill md-pill-conf-med">MEDIUM CONFIDENCE</span>
            </div>
        </div>
        <div class="logic-box" style="margin-top:14px;">
            <div class="logic-box-head">&#128202; SCORING LOGIC</div>
            <div class="logic-grid">
                <div class="logic-item"><span class="lc-bull">BULLISH</span><span class="lv">Diff &ge; +3</span> &middot; Above SMAs, oversold RSI, +MACD, PCR &gt; 1.2</div>
                <div class="logic-item"><span class="lc-bear">BEARISH</span><span class="lv">Diff &le; &minus;3</span> &middot; Below SMAs, overbought RSI, &minus;MACD, PCR &lt; 0.7</div>
                <div class="logic-item"><span class="lc-side">SIDEWAYS</span><span class="lv">Diff &minus;2 to +2</span> &middot; Mixed signals, consolidation</div>
                <div class="logic-item"><span class="lc-info">CONFIDENCE</span> HIGH when gap &ge; 4 &nbsp;&middot;&nbsp; OI scope: ATM &plusmn;10 only</div>
            </div>
        </div>
    </div>

        <div class="section">
            <div class="section-title"><span>&#128269;</span> TECHNICAL INDICATORS</div>
            <div class="card-grid grid-5">
            <div class="g ">
                <div class="card-top-row"><span class="card-ico">üü°</span><div class="lbl">RSI (14)</div></div>
                <span class="val">49.9</span>
                <div class="bar-wrap"><div class="bar-fill bar-gold" style="width:49.9%"></div></div>
                <div class="card-foot"><div class="sub">14-period momentum</div><span class="tag tag-neu">Neutral</span></div>
            </div>
            <div class="g g-hi">
                <div class="card-top-row"><span class="card-ico">‚úÖ</span><div class="lbl">SMA 20</div></div>
                <span class="val">‚Çπ25,637</span>
                <div class="bar-wrap"><div class="bar-fill bar-teal" style="width:50.1%"></div></div>
                <div class="card-foot"><div class="sub">20-day average</div><span class="tag tag-bull">Above</span></div>
            </div>
            <div class="g g-red">
                <div class="card-top-row"><span class="card-ico">‚ùå</span><div class="lbl">SMA 50</div></div>
                <span class="val">‚Çπ25,742</span>
                <div class="bar-wrap"><div class="bar-fill bar-red" style="width:46.0%"></div></div>
                <div class="card-foot"><div class="sub">50-day average</div><span class="tag tag-bear">Below</span></div>
            </div>
            <div class="g g-hi">
                <div class="card-top-row"><span class="card-ico">‚úÖ</span><div class="lbl">SMA 200</div></div>
                <span class="val">‚Çπ25,343</span>
                <div class="bar-wrap"><div class="bar-fill bar-teal" style="width:61.7%"></div></div>
                <div class="card-foot"><div class="sub">200-day average</div><span class="tag tag-bull">Above</span></div>
            </div>
            <div class="g g-red">
                <div class="card-top-row"><span class="card-ico">üî¥</span><div class="lbl">MACD</div></div>
                <span class="val">-19.58</span>
                <div class="bar-wrap"><div class="bar-fill bar-red" style="width:10.8%"></div></div>
                <div class="card-foot"><div class="sub">Signal: -14.70</div><span class="tag tag-bear">Bearish</span></div>
            </div></div>
        </div>

        <div class="section">
            <div class="section-title"><span>&#127919;</span> OPTION CHAIN ANALYSIS <span style="font-size:11px;color:#80deea;font-weight:400;letter-spacing:1px;">(ATM ¬±10 Strikes Only)</span></div>
            <div class="card-grid grid-4">
            <div class="g ">
                <div class="card-top-row"><span class="card-ico">üü°</span><div class="lbl">PCR Ratio (OI)</div></div>
                <span class="val">1.054</span>
                <div class="bar-wrap"><div class="bar-fill bar-gold" style="width:52.7%"></div></div>
                <div class="card-foot"><div class="sub">Put/Call OI ratio</div><span class="tag tag-neu">Neutral</span></div>
            </div>
            <div class="g ">
                <div class="card-top-row"><span class="card-ico">üéØ</span><div class="lbl">Max Pain</div></div>
                <span class="val">‚Çπ25,650</span>
                <div class="bar-wrap"><div class="bar-fill bar-gold" style="width:50.0%"></div></div>
                <div class="card-foot"><div class="sub">Price gravity level</div><span class="tag tag-neu">Expiry Magnet</span></div>
            </div>
            <div class="g g-red">
                <div class="card-top-row"><span class="card-ico">üî¥</span><div class="lbl">Max Call OI</div></div>
                <span class="val">‚Çπ26,000</span>
                <div class="bar-wrap"><div class="bar-fill bar-red" style="width:48.7%"></div></div>
                <div class="card-foot"><div class="sub">CE wall</div><span class="tag tag-bear">Resistance</span></div>
            </div>
            <div class="g g-hi">
                <div class="card-top-row"><span class="card-ico">üü¢</span><div class="lbl">Max Put OI</div></div>
                <span class="val">‚Çπ25,500</span>
                <div class="bar-wrap"><div class="bar-fill bar-teal" style="width:51.3%"></div></div>
                <div class="card-foot"><div class="sub">PE floor</div><span class="tag tag-bull">Support</span></div>
            </div></div>
        </div>

        <div class="section">
            <div class="disclaimer"><strong>‚ö†Ô∏è DISCLAIMER</strong><br><br>
            This report is for <strong>EDUCATIONAL purposes only</strong> ‚Äî NOT financial advice.<br>
            Always use stop losses and consult a SEBI registered investment advisor.<br>
            Past performance does not guarantee future results.</div>
        </div>
    </div><!-- /tab-main -->

    <!-- TAB 3: INTRADAY OI TREND -->
    <div class="tab-panel" id="tab-oi-trend">
      <div class="section">
        <div class="section-title">
          <span>&#128202;</span> INTRADAY OI TREND
          <span class="annot-badge">AUTO-LOGGED EVERY RUN &middot; IST</span>
          <span style="font-size:10px;color:rgba(128,222,234,0.35);font-weight:400;margin-left:auto;">
            Source: <code style="color:#4fc3f7;font-family:'JetBrains Mono',monospace;">oi_log.json</code>
          </span>
        </div>

        <!-- Controls Row -->
        <div class="oi-controls">
          <div class="oi-interval-btns">
            <button class="oi-int-btn active" id="btn3" onclick="setOIInterval(3,this)">3 Min</button>
            <button class="oi-int-btn" id="btn5" onclick="setOIInterval(5,this)">5 Min</button>
            <button class="oi-int-btn" id="btn15" onclick="setOIInterval(15,this)">15 Min</button>
          </div>
          <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
            <div class="oi-live-badge"><span class="oi-live-dot"></span> LIVE &middot; IST &middot; Auto-refresh 30s</div>
            <div id="oiLastFetch" style="font-family:'JetBrains Mono',monospace;font-size:9px;color:rgba(128,222,234,0.3);letter-spacing:1px;">Last fetch: ‚Äî</div>
          </div>
        </div>

        <!-- Summary Strip -->
        <div class="oi-summary-strip">
          <div class="oi-sum-card">
            <div class="oi-sum-label">Latest PCR</div>
            <div class="oi-sum-val oi-pcr-val" id="oiLatestPCR">‚Äî</div>
          </div>
          <div class="oi-sum-card">
            <div class="oi-sum-label">Net OI Diff</div>
            <div class="oi-sum-val" id="oiLatestDiff">‚Äî</div>
          </div>
          <div class="oi-sum-card">
            <div class="oi-sum-label">Spot Price</div>
            <div class="oi-sum-val oi-spot-cell" id="oiLatestSpot">‚Äî</div>
          </div>
          <div class="oi-sum-card">
            <div class="oi-sum-label">OI Signal</div>
            <div class="oi-sum-val" id="oiLatestSignal">‚Äî</div>
          </div>
        </div>

        <!-- Sparkline Chart -->
        <div class="oi-chart-wrap">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
            <div class="oi-chart-label">NET OI DIFF (PE &#916; &#8722; CE &#916;) &mdash; INTRADAY SPARKLINE</div>
            <div id="oiChartEntries" style="font-family:'JetBrains Mono',monospace;font-size:9px;color:rgba(128,222,234,0.3);letter-spacing:1px;"></div>
          </div>
          <canvas id="oiSparklineCanvas" style="width:100%;height:110px;display:block;"></canvas>
        </div>

        <!-- Table -->
        <div class="oi-table-wrap">
          <table class="oi-table">
            <thead>
              <tr>
                <th style="text-align:left;">TIME (IST)</th>
                <th>CALL OI &#916;</th>
                <th>PUT OI &#916;</th>
                <th>DIFF</th>
                <th>PCR</th>
                <th>OPTION SIGNAL</th>
                <th>VWAP</th>
                <th>FUT PRICE</th>
                <th>SPOT PRICE</th>
                <th>VWAP SIGNAL</th>
              </tr>
            </thead>
            <tbody id="oiTableBody">
              <tr><td colspan="10" class="oi-empty-state">&#8987; Loading oi_log.json&hellip;</td></tr>
            </tbody>
          </table>
        </div>

        <!-- How to Read -->
        <div class="logic-box" style="margin-top:16px;">
          <div class="logic-box-head">&#128214; HOW TO READ THIS TABLE</div>
          <div class="logic-grid">
            <div class="logic-item"><span class="lc-bear">Call OI +</span> Writers adding calls &#8594; Bearish pressure</div>
            <div class="logic-item"><span class="lc-bull">Put OI +</span> Writers adding puts &#8594; Bullish support</div>
            <div class="logic-item"><span class="lc-info">DIFF</span> = PE &#916; &#8722; CE &#916; &nbsp;&middot;&nbsp; <span class="lc-bull">+ve = Bullish</span> &nbsp;<span class="lc-bear">&#8722;ve = Bearish</span></div>
            <div class="logic-item"><span class="lc-info">3/5/15 Min</span> filters raw rows or aggregates into time slots</div>
            <div class="logic-item"><span class="lc-info">VWAP Signal</span> BUY = Spot &ge; VWAP &nbsp;&middot;&nbsp; SELL = Spot &lt; VWAP</div>
            <div class="logic-item"><span class="lc-info">Timestamps</span> All times shown in IST (Asia/Kolkata)</div>
          </div>
        </div>
      </div>
    </div><!-- /tab-oi-trend -->

    <div class="tab-panel" id="tab-checklist">
        <div class="section">
            <div class="section-title">
                <span>&#9881;&#65039;</span> LIVE DATA INPUTS
                <span class="annot-badge">AUTO-FILLED FROM LIVE NSE DATA</span>
                <span style="font-size:10px;color:rgba(128,222,234,0.35);font-weight:400;margin-left:auto;">As of: 25-Feb-2026 10:20 IST</span>
            </div>
            <div class="input-summary-grid">
                <div class="inp-summary-card inp-auto-card">
                    <div class="inp-s-label">PCR (OI)</div>
                    <div class="inp-s-val">1.054</div>
                    <div class="inp-s-src">Option Chain</div>
                </div>
                <div class="inp-summary-card inp-auto-card">
                    <div class="inp-s-label">RSI (14)</div>
                    <div class="inp-s-val">49.9</div>
                    <div class="inp-s-src">Technical</div>
                </div>
                <div class="inp-summary-card inp-auto-card">
                    <div class="inp-s-label">MACD</div>
                    <div class="inp-s-val"><span class="na-inline">N/A</span></div>
                    <div class="inp-s-src">Technical</div>
                </div>
                <div class="inp-summary-card inp-auto-card">
                    <div class="inp-s-label">Market Trend</div>
                    <div class="inp-s-val">Mixed</div>
                    <div class="inp-s-src">SMA 20/50/200</div>
                </div>
                <div class="inp-summary-card inp-auto-card">
                    <div class="inp-s-label">OI Direction</div>
                    <div class="inp-s-val">Bullish</div>
                    <div class="inp-s-src">CHG OI</div>
                </div>
                <div class="inp-summary-card inp-manual-card">
                    <div class="inp-s-label">Global Bias</div>
                    <div class="inp-s-val"><span class="na-inline">N/A</span></div>
                    <div class="inp-s-src">Manual Input</div>
                </div>
                <div class="inp-summary-card inp-manual-card">
                    <div class="inp-s-label">Vol at Support</div>
                    <div class="inp-s-val"><span class="na-inline">N/A</span></div>
                    <div class="inp-s-src">Manual Input</div>
                </div>
                <div class="inp-summary-card inp-manual-card">
                    <div class="inp-s-label">Vol at Resistance</div>
                    <div class="inp-s-val"><span class="na-inline">N/A</span></div>
                    <div class="inp-s-src">Manual Input</div>
                </div>
                <div class="inp-summary-card inp-manual-card">
                    <div class="inp-s-label">IV View</div>
                    <div class="inp-s-val">NORMAL</div>
                    <div class="inp-s-src">Manual Input</div>
                </div>
            </div>
        </div>
        <div class="section">
            <div class="section-title">
                <span>&#128203;</span> SIGNAL CHECKLIST
                <span style="font-size:10px;color:rgba(128,222,234,0.35);font-weight:400;margin-left:auto;">
                    2 Bullish &middot; 1 Bearish &middot; 2 Neutral &middot; 3 N/A
                </span>
            </div>
            <div class="signal-grid">
        <div class="sig-card">
            <div class="sig-icon sig-neu">üìä</div>
            <div class="sig-body">
                <div class="sig-name">PCR (OI Ratio) <span class="auto-badge">AUTO</span></div>
                <div class="sig-val">1.054</div>
                <div class="sig-msg">PCR 1.054 ‚Üí in 0.8‚Äì1.2 range ‚Äî neutral/mixed sentiment</div>
            </div>
            <div class="sig-score score-0">0</div>
        </div>
        <div class="sig-card">
            <div class="sig-icon sig-neu">üìà</div>
            <div class="sig-body">
                <div class="sig-name">RSI (14-Day) <span class="auto-badge">AUTO</span></div>
                <div class="sig-val">49.9</div>
                <div class="sig-msg">RSI 49.9 ‚Üí 40‚Äì60 zone ‚Äî neutral, no overbought/oversold signal</div>
            </div>
            <div class="sig-score score-0">0</div>
        </div>
        <div class="sig-card">
            <div class="sig-icon sig-bear">‚ö°</div>
            <div class="sig-body">
                <div class="sig-name">MACD Signal <span class="auto-badge">AUTO</span></div>
                <div class="sig-val">Bearish Crossover</div>
                <div class="sig-msg">MACD crossed below signal line ‚Äî bearish momentum</div>
            </div>
            <div class="sig-score score-n">-1</div>
        </div>
        <div class="sig-card">
            <div class="sig-icon sig-bull">üìâ</div>
            <div class="sig-body">
                <div class="sig-name">Market Trend (SMAs) <span class="auto-badge">AUTO</span></div>
                <div class="sig-val">Uptrend</div>
                <div class="sig-msg">Price above majority of SMAs ‚Äî uptrend intact</div>
            </div>
            <div class="sig-score score-p">+1</div>
        </div>
        <div class="sig-card">
            <div class="sig-icon sig-bull">üîÑ</div>
            <div class="sig-body">
                <div class="sig-name">OI Direction <span class="auto-badge">AUTO</span></div>
                <div class="sig-val">Bullish OI</div>
                <div class="sig-msg">Net OI change is bullish ‚Äî put build-up / call unwinding dominant</div>
            </div>
            <div class="sig-score score-p">+1</div>
        </div>
        <div class="sig-card">
            <div class="sig-icon sig-na">üåê</div>
            <div class="sig-body">
                <div class="sig-name">Global Market Bias <span class="manual-badge">MANUAL</span></div>
                <div class="sig-val na-val">N/A</div>
                <div class="sig-msg">Global bias not provided</div>
            </div>
            <div class="sig-score score-na">N/A</div>
        </div>
        <div class="sig-card">
            <div class="sig-icon sig-na">üì¶</div>
            <div class="sig-body">
                <div class="sig-name">Volume at Support <span class="manual-badge">MANUAL</span></div>
                <div class="sig-val na-val">N/A</div>
                <div class="sig-msg">Volume at support not provided ‚Äî skipped</div>
            </div>
            <div class="sig-score score-na">N/A</div>
        </div>
        <div class="sig-card">
            <div class="sig-icon sig-na">üì¶</div>
            <div class="sig-body">
                <div class="sig-name">Volume at Resistance <span class="manual-badge">MANUAL</span></div>
                <div class="sig-val na-val">N/A</div>
                <div class="sig-msg">Volume at resistance not provided ‚Äî skipped</div>
            </div>
            <div class="sig-score score-na">N/A</div>
        </div></div>
            <div class="score-meter">
                <div class="score-ring-wrap">
                    <svg width="120" height="120" viewBox="0 0 110 110">
                        <circle cx="55" cy="55" r="46" fill="none" stroke="rgba(79,195,247,0.08)" stroke-width="9"/>
                        <circle cx="55" cy="55" r="46" fill="none"
                            stroke="#69f0ae" stroke-width="9"
                            stroke-linecap="round"
                            stroke-dasharray="289.0"
                            stroke-dashoffset="252.9"
                            style="transform:rotate(-90deg);transform-origin:55px 55px;"/>
                    </svg>
                    <div class="score-ring-label">
                        <div class="score-ring-num" style="color:#69f0ae;">+1</div>
                        <div class="score-ring-txt">SCORE</div>
                    </div>
                </div>
                <div class="score-detail">
                    <div class="score-bias-lbl" style="background:linear-gradient(135deg,#69f0ae,#00c853);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">MILDLY BULLISH</div>
                    <div class="score-sub">
                        Score +1 from 8 signals (3 skipped as N/A).<br>
                        Moderate signal ‚Äî size positions conservatively.
                    </div>
                    <div class="score-pills">
                        <span class="sc-pill sc-pill-bull">&#10003; BULL: 2</span>
                        <span class="sc-pill sc-pill-bear">&#10007; BEAR: 1</span>
                        <span class="sc-pill sc-pill-neu">&#9633; NEUTRAL: 2</span>
                        <span class="sc-pill sc-pill-na">‚Äî N/A: 3</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="section">
            <div class="section-title">
                <span>&#127919;</span> SUGGESTED STRATEGY TYPES
                <span style="font-size:10px;color:rgba(176,190,197,0.4);font-weight:400;letter-spacing:1px;">
                    For study &amp; backtesting only &mdash; NOT financial advice
                </span>
            </div>
            <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;margin-bottom:16px;">
                <div style="font-size:12px;color:rgba(176,190,197,0.4);">
                    IV View: <strong style="color:#69f0ae;">NORMAL</strong>
                    &nbsp;&middot;&nbsp; Bias: <strong style="color:#69f0ae;">MILDLY BULLISH</strong>
                    &nbsp;&middot;&nbsp; <span style="color:rgba(128,222,234,0.4);">7 strategies found</span>
                </div>
                <div style="display:flex;gap:8px;flex-wrap:wrap;">
                    <button class="filter-btn active" onclick="filterStrats('all',this)">All</button>
                    <button class="filter-btn" onclick="filterStrats('bullish',this)">&#128994; Bullish</button>
                    <button class="filter-btn" onclick="filterStrats('bearish',this)">&#128308; Bearish</button>
                    <button class="filter-btn" onclick="filterStrats('neutral',this)">&#128993; Neutral</button>
                    <button class="filter-btn" onclick="filterStrats('volatility',this)">&#128995; Volatility</button>
                    <button class="filter-btn" onclick="filterStrats('advanced',this)">&#128309; Advanced</button>
                </div>
            </div>
            <div class="strat-grid" id="stratGrid">
        <div class="strat-card strat-bull" data-type="bullish">
            <div class="strat-num">01 ¬∑ PRIMARY</div>
            <div class="strat-name">Bull Call Spread</div>
            <span class="strat-tag strat-tag-bull">üü¢ Bullish</span>
        </div>
        <div class="strat-card strat-bull" data-type="bullish">
            <div class="strat-num">02 ¬∑ PRIMARY</div>
            <div class="strat-name">Bull Put Spread</div>
            <span class="strat-tag strat-tag-bull">üü¢ Bullish</span>
        </div>
        <div class="strat-card strat-bull" data-type="bullish">
            <div class="strat-num">03 ¬∑ PRIMARY</div>
            <div class="strat-name">Jade Lizard</div>
            <span class="strat-tag strat-tag-bull">üü¢ Bullish</span>
        </div>
        <div class="strat-card strat-bull" data-type="bullish">
            <div class="strat-num">04 ¬∑ PRIMARY</div>
            <div class="strat-name">The Wheel Strategy (CSP + Covered Call)</div>
            <span class="strat-tag strat-tag-bull">üü¢ Bullish</span>
        </div>
        <div class="strat-card strat-misc" data-type="advanced">
            <div class="strat-num">05 ¬∑ SECONDARY</div>
            <div class="strat-name">Call Ratio Spread</div>
            <span class="strat-tag strat-tag-misc">üîµ Advanced</span>
        </div>
        <div class="strat-card strat-misc" data-type="advanced">
            <div class="strat-num">06 ¬∑ SECONDARY</div>
            <div class="strat-name">Put Ratio Spread</div>
            <span class="strat-tag strat-tag-misc">üîµ Advanced</span>
        </div>
        <div class="strat-card strat-misc" data-type="advanced">
            <div class="strat-num">07 ¬∑ SECONDARY</div>
            <div class="strat-name">Christmas Tree Spread</div>
            <span class="strat-tag strat-tag-misc">üîµ Advanced</span>
        </div></div>
        </div>
        <div class="section">
            <div class="section-title"><span>&#128218;</span> SCORING LEGEND</div>
            <div class="logic-box" style="margin-top:0;">
                <div class="logic-box-head">HOW THE SCORE WORKS</div>
                <div class="logic-grid">
                    <div class="logic-item"><span class="lc-bull">+1</span> Signal is bullish &mdash; adds to bull case</div>
                    <div class="logic-item"><span class="lc-bear">&minus;1</span> Signal is bearish &mdash; adds to bear case</div>
                    <div class="logic-item"><span class="lc-side">0</span> Neutral signal &mdash; no directional contribution</div>
                    <div class="logic-item"><span class="lc-info">N/A</span> Data not available &mdash; excluded from score</div>
                    <div class="logic-item"><span class="lc-bull">&ge; +3</span> Strongly Bullish &middot; <span class="lc-bull">+1/+2</span> Mildly Bullish</div>
                    <div class="logic-item"><span class="lc-bear">&le; &minus;3</span> Strongly Bearish &middot; <span class="lc-bear">&minus;1/&minus;2</span> Mildly Bearish</div>
                    <div class="logic-item"><span class="lc-info">AUTO</span> Filled from live NSE + yfinance data</div>
                    <div class="logic-item"><span class="lc-side">MANUAL</span> Requires your input &mdash; shown as N/A if not set</div>
                </div>
            </div>
        </div>
        <div class="section">
            <div class="disclaimer">
                <strong>&#9888;&#65039; DISCLAIMER</strong><br><br>
                This checklist is for <strong>EDUCATIONAL purposes only</strong> &mdash; NOT financial advice.<br>
                Strategy suggestions are based on a rules-based scoring model and have not been backtested.<br>
                Always validate with your own analysis. Consult a SEBI-registered investment advisor.
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Automated Nifty 50 ¬∑ Option Chain + Technical + Intraday OI Trend + Strategy Checklist</p>
        <p style="margin-top:6px;">&#169; 2026 ¬∑ Deep Ocean Theme ¬∑ Navy Command OI ¬∑ Pulse Flow FII/DII ¬∑ IST Timestamps ¬∑ For Educational Purposes Only</p>
    </div>
</div>

<script>
(function() {
    /* ‚îÄ‚îÄ Silent page refresh every 30s ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    var INTERVAL  = 30000;
    var countdown = INTERVAL / 1000;

    function istNow() { return new Date(new Date().toLocaleString('en-US',{timeZone:'Asia/Kolkata'})); }
    function pad(n){ return String(n).padStart(2,'0'); }
    function fmtTime(d){ return pad(d.getHours())+':'+pad(d.getMinutes())+':'+pad(d.getSeconds()); }
    function fmtDate(d){
        var M=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        return pad(d.getDate())+'-'+M[d.getMonth()]+'-'+d.getFullYear();
    }
    function tick() {
        var now = istNow();
        var clockEl = document.getElementById('live-ist-clock');
        if (clockEl) clockEl.textContent = fmtDate(now) + '  ' + fmtTime(now) + ' IST';
        countdown--;
        if (countdown < 0) countdown = INTERVAL / 1000;
        var cdEl = document.getElementById('refresh-countdown');
        if (cdEl) { var s=countdown%60; var m=Math.floor(countdown/60); cdEl.textContent=(m>0?m+'m ':'')+s+'s'; }
    }
    setInterval(tick, 1000);
    tick();

    function silentRefresh() {
        fetch(window.location.href+'?_t='+Date.now(),{cache:'no-store'})
            .then(function(r){ return r.text(); })
            .then(function(html){
                var parser=new DOMParser(); var newDoc=parser.parseFromString(html,'text/html');
                var newCont=newDoc.querySelector('.container'); var oldCont=document.querySelector('.container');
                if(!newCont||!oldCont) return;
                var sy=window.scrollY||window.pageYOffset;
                var activeTab=document.querySelector('.tab-btn.active');
                var activeTabId=activeTab?activeTab.dataset.tab:'main';
                oldCont.innerHTML=newCont.innerHTML;
                window.scrollTo({top:sy,behavior:'instant'});
                switchTab(activeTabId);
                var now=istNow(); var stamp=fmtDate(now)+'  '+fmtTime(now)+' IST';
                var el=document.getElementById('last-updated'); if(el) el.textContent=stamp;
                countdown=INTERVAL/1000;
                if(activeTabId==='oi-trend') loadOILog();
            })
            .catch(function(e){ console.warn('Refresh failed:',e); });
    }
    setInterval(silentRefresh, INTERVAL);
})();

/* ‚îÄ‚îÄ Tab switching ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
function switchTab(tab) {
    document.querySelectorAll('.tab-panel').forEach(function(p){ p.classList.remove('active'); });
    document.querySelectorAll('.tab-btn').forEach(function(b){ b.classList.remove('active'); });
    var panel=document.getElementById('tab-'+tab);
    var btn=document.querySelector('[data-tab="'+tab+'"]');
    if(panel) panel.classList.add('active');
    if(btn)   btn.classList.add('active');
    if(tab==='oi-trend') loadOILog();
}

/* ‚îÄ‚îÄ Strategy filter ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
function filterStrats(type, btn) {
    document.querySelectorAll('.filter-btn').forEach(function(b){ b.classList.remove('active'); });
    btn.classList.add('active');
    document.querySelectorAll('.strat-card').forEach(function(c){
        c.style.display=(type==='all'||c.dataset.type===type)?'':'none';
    });
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   INTRADAY OI TREND ‚Äî complete client-side engine
   Reads oi_log.json ¬∑ Filters 3/5/15 min ¬∑ Sparkline via Canvas
   All timestamps are IST (written by Python with pytz Asia/Kolkata)
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
var _oiInterval = 3;
var _oiData     = [];

function setOIInterval(mins, btn) {
    _oiInterval = mins;
    document.querySelectorAll('.oi-int-btn').forEach(function(b){ b.classList.remove('active'); });
    btn.classList.add('active');
    renderOITable(_oiData);
}

/* Format large Indian numbers: 5,70,43,740 ‚Üí "+5.70 Cr" */
function fmtIN(n) {
    var abs = Math.abs(n);
    var sign = n < 0 ? '-' : '+';
    if (abs >= 10000000) return sign + (abs/10000000).toFixed(2) + ' Cr';
    if (abs >= 100000)   return sign + (abs/100000).toFixed(2)   + ' L';
    if (abs === 0)       return '0';
    return (n < 0 ? '-' : '+') + abs.toLocaleString('en-IN');
}

function signalHtml(sig) {
    var s = (sig||'').toUpperCase().trim();
    if (s === 'STRONG SELL') return '<span class="oi-signal-ssell">STRONG SELL</span>';
    if (s === 'SELL')        return '<span class="oi-signal-sell">SELL</span>';
    if (s === 'STRONG BUY')  return '<span class="oi-signal-sbuy">STRONG BUY</span>';
    if (s === 'BUY')         return '<span class="oi-signal-buy">BUY</span>';
    return '<span class="oi-signal-neutral">NEUTRAL</span>';
}

function vsigHtml(sig) {
    return (sig||'').toUpperCase() === 'BUY'
        ? '<span class="oi-vsig-buy">BUY</span>'
        : '<span class="oi-vsig-sell">SELL</span>';
}

/* Aggregate raw (3-min) data into 5-min or 15-min slots */
function filterByInterval(data, mins) {
    if (mins === 3) return data;
    var grouped = {};
    data.forEach(function(row) {
        var parts    = (row.time||'00:00').split(':');
        var h        = parseInt(parts[0]||0);
        var m        = parseInt(parts[1]||0);
        var slotMin  = Math.floor(m / mins) * mins;
        var key      = String(h).padStart(2,'0') + ':' + String(slotMin).padStart(2,'0');
        if (!grouped[key]) grouped[key] = [];
        grouped[key].push(row);
    });
    /* Sort keys descending (newest first, matching 3-min order) */
    var keys = Object.keys(grouped).sort().reverse();
    return keys.map(function(key) {
        var rows    = grouped[key];
        var last    = rows[rows.length - 1];
        var totalCE = rows.reduce(function(a,r){ return a+(r.call_oi_chg||0); }, 0);
        var totalPE = rows.reduce(function(a,r){ return a+(r.put_oi_chg||0); }, 0);
        return {
            time:        key + ' IST',
            call_oi_chg: totalCE,
            put_oi_chg:  totalPE,
            diff:        totalPE - totalCE,
            pcr:         last.pcr,
            opt_signal:  last.opt_signal,
            vwap:        last.vwap,
            fut_price:   last.fut_price,
            spot_price:  last.spot_price,
            vwap_signal: last.vwap_signal,
            _isLive:     rows[0]._isLive,   /* first in slot = newest */
        };
    });
}

function renderOITable(data) {
    var tbody = document.getElementById('oiTableBody');
    if (!tbody) return;

    if (!data || data.length === 0) {
        tbody.innerHTML = '<tr><td colspan="10" class="oi-empty-state">' +
            '&#128218; No data yet.<br>' +
            '<small style="opacity:0.5;">oi_log.json will populate when the script runs during market hours.</small>' +
            '</td></tr>';
        return;
    }

    var filtered = filterByInterval(data, _oiInterval);

    /* Update summary strip from latest row */
    var latest = filtered[0];
    if (latest) {
        var el;
        el = document.getElementById('oiLatestPCR');
        if (el) el.textContent = latest.pcr || '‚Äî';

        el = document.getElementById('oiLatestDiff');
        if (el) {
            el.textContent  = fmtIN(latest.diff || 0);
            el.className    = 'oi-sum-val ' + ((latest.diff||0) >= 0 ? 'oi-diff-pos' : 'oi-diff-neg');
        }
        el = document.getElementById('oiLatestSpot');
        if (el) el.textContent = '‚Çπ' + ((latest.spot_price||0).toLocaleString('en-IN'));

        el = document.getElementById('oiLatestSignal');
        if (el) el.innerHTML = signalHtml(latest.opt_signal);
    }

    /* Chart entries count */
    var ce = document.getElementById('oiChartEntries');
    if (ce) ce.textContent = filtered.length + ' candles';

    /* Draw sparkline */
    drawSparkline(filtered);

    /* Render table rows */
    var html = '';
    filtered.forEach(function(row) {
        var isLive   = !!row._isLive;
        var diffCls  = (row.diff||0) >= 0 ? 'oi-diff-pos' : 'oi-diff-neg';
        var timeCell = isLive
            ? '<div class="oi-time-cell">' + (row.time||'') +
              '&nbsp;<span class="oi-live-ind">LIVE</span></div>'
            : (row.time||'');

        html += '<tr class="' + (isLive ? 'oi-live-row' : '') + '">'
            + '<td>' + timeCell + '</td>'
            + '<td class="oi-call-val">' + fmtIN(row.call_oi_chg||0) + '</td>'
            + '<td class="oi-put-val">'  + fmtIN(row.put_oi_chg||0)  + '</td>'
            + '<td class="' + diffCls + '">' + fmtIN(row.diff||0) + '</td>'
            + '<td class="oi-pcr-val">'  + (row.pcr||'‚Äî') + '</td>'
            + '<td>' + signalHtml(row.opt_signal) + '</td>'
            + '<td class="oi-vwap-cell">'+ (row.vwap ? row.vwap.toFixed(2) : '‚Äî') + '</td>'
            + '<td class="oi-fut-cell">' + (row.fut_price ? row.fut_price.toFixed(2) : '‚Äî') + '</td>'
            + '<td class="oi-spot-cell">'+ (row.spot_price ? row.spot_price.toFixed(2) : '‚Äî') + '</td>'
            + '<td>' + vsigHtml(row.vwap_signal) + '</td>'
            + '</tr>';
    });
    tbody.innerHTML = html;
}

function drawSparkline(data) {
    var canvas = document.getElementById('oiSparklineCanvas');
    if (!canvas || !canvas.getContext) return;
    var ctx = canvas.getContext('2d');
    var W   = canvas.parentElement ? (canvas.parentElement.clientWidth - 32) : 600;
    var H   = 110;
    canvas.width  = W;
    canvas.height = H;

    /* Reverse for left‚Üíright time order in chart */
    var reversed = data.slice().reverse();
    var diffs    = reversed.map(function(r){ return r.diff || 0; });
    if (diffs.length < 2) {
        ctx.clearRect(0,0,W,H);
        ctx.fillStyle = 'rgba(128,222,234,0.2)';
        ctx.font = '12px JetBrains Mono, monospace';
        ctx.textAlign = 'center';
        ctx.fillText('Waiting for data‚Ä¶', W/2, H/2);
        return;
    }

    var minV  = Math.min.apply(null, diffs);
    var maxV  = Math.max.apply(null, diffs);
    var range = (maxV - minV) || 1;
    var pad   = 10;

    function toX(i) { return (i / (diffs.length-1)) * (W - 2*pad) + pad; }
    function toY(v) { return H - ((v - minV) / range) * (H - 2*pad) - pad; }

    ctx.clearRect(0, 0, W, H);

    /* Zero line */
    var zeroY = toY(0);
    ctx.save();
    ctx.strokeStyle = 'rgba(79,195,247,0.18)';
    ctx.lineWidth   = 1;
    ctx.setLineDash([4, 4]);
    ctx.beginPath(); ctx.moveTo(pad, zeroY); ctx.lineTo(W-pad, zeroY); ctx.stroke();
    ctx.restore();

    /* Colour by last diff value */
    var lastDiff  = diffs[diffs.length-1];
    var lineColor = lastDiff >= 0 ? '#10b981' : '#ef4444';
    var gradTop   = lastDiff >= 0 ? 'rgba(16,185,129,0.35)' : 'rgba(239,68,68,0.35)';

    /* Area fill */
    var grad = ctx.createLinearGradient(0, 0, 0, H);
    grad.addColorStop(0, gradTop);
    grad.addColorStop(1, 'rgba(0,0,0,0)');
    ctx.beginPath();
    ctx.moveTo(toX(0), H);
    diffs.forEach(function(v,i){ ctx.lineTo(toX(i), toY(v)); });
    ctx.lineTo(toX(diffs.length-1), H);
    ctx.closePath();
    ctx.fillStyle = grad;
    ctx.fill();

    /* Line */
    ctx.strokeStyle = lineColor;
    ctx.lineWidth   = 2.5;
    ctx.lineJoin    = 'round';
    ctx.beginPath();
    diffs.forEach(function(v,i){
        i === 0 ? ctx.moveTo(toX(i), toY(v)) : ctx.lineTo(toX(i), toY(v));
    });
    ctx.stroke();

    /* Data-point dots */
    diffs.forEach(function(v,i){
        ctx.beginPath();
        ctx.arc(toX(i), toY(v), 2.5, 0, Math.PI*2);
        ctx.fillStyle = lineColor;
        ctx.globalAlpha = 0.7;
        ctx.fill();
        ctx.globalAlpha = 1;
    });

    /* Latest dot (highlighted) */
    var lx = toX(diffs.length-1);
    var ly = toY(diffs[diffs.length-1]);
    ctx.beginPath(); ctx.arc(lx, ly, 5, 0, Math.PI*2);
    ctx.fillStyle = lineColor; ctx.fill();
    ctx.beginPath(); ctx.arc(lx, ly, 9, 0, Math.PI*2);
    ctx.strokeStyle = lastDiff >= 0 ? 'rgba(52,211,153,0.35)' : 'rgba(248,113,113,0.35)';
    ctx.lineWidth = 2; ctx.stroke();
}

/* Fetch oi_log.json from same directory as index.html */
function loadOILog() {
    var url = 'oi_log.json?_t=' + Date.now();
    fetch(url, {cache:'no-store'})
        .then(function(r){
            if (!r.ok) throw new Error('HTTP ' + r.status);
            return r.json();
        })
        .then(function(data) {
            if (Array.isArray(data) && data.length > 0) {
                data[0]._isLive = true;      /* Mark newest row as LIVE */
                _oiData = data;
                renderOITable(data);
                /* Update last fetch time in IST */
                var now = new Date(new Date().toLocaleString('en-US',{timeZone:'Asia/Kolkata'}));
                var el  = document.getElementById('oiLastFetch');
                if (el) el.textContent = 'Last fetch: ' +
                    String(now.getHours()).padStart(2,'0') + ':' +
                    String(now.getMinutes()).padStart(2,'0') + ':' +
                    String(now.getSeconds()).padStart(2,'0') + ' IST';
            }
        })
        .catch(function(e) {
            console.warn('OI log fetch failed:', e);
            var tbody = document.getElementById('oiTableBody');
            if (tbody) tbody.innerHTML =
                '<tr><td colspan="10" class="oi-empty-state">' +
                '&#9888; Could not load oi_log.json<br>' +
                '<small style="opacity:0.5;">Ensure the file is deployed to gh-pages alongside index.html</small>' +
                '</td></tr>';
        });
}

/* Load OI log when page loads (handles direct URL to tab) */
window.addEventListener('load', function(){
    if (window.location.hash === '#oi-trend') { switchTab('oi-trend'); }
    else { loadOILog(); }   /* pre-load silently even on main tab */
});

/* Also refresh OI log every 30s independently */
setInterval(loadOILog, 30000);

/* Redraw sparkline on window resize */
window.addEventListener('resize', function(){
    if (_oiData.length > 0) drawSparkline(filterByInterval(_oiData, _oiInterval));
});
</script>

</body></html>